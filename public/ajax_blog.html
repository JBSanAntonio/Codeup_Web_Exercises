<!DOCTYPE html>

<html>
<head>
	<title>Ajax Blog</title>
    <link rel="stylesheet" href="/css/bootstrap.css">
	<link rel="stylesheet" type="text/css" href="/css/ajaxBlog.css">
</head>
<body>
        <h1><strong>Venue & Vine</strong>
            <p></p>
            <p></p>
            <p class = "aboutPara"><strong>Wine, cuisine and scene</strong></p>
            <p></p>
            <p></p>
            <p></p>
            <p class = "blog"><strong>Blog Site</strong></p>
    </h1>
<div id="posts"> 

    <div class = "row">

        <div class="col-md-6 archivedPosts">
            <h2 class="title">Blog Post</h2>
                <p class="content">Blog Post Content:</p>
            <h3 class="categories">Blog Categories:</h3>
            <h4 class="date">Date:</h4>
        </div>
        <div class = "col-md-6 newPosts">
            <h2 class="title">Create a New Post</h2>
             <div class="col-md-6">
                <label for="post-title">Title:</label>
                <input id="post-title" name="newPostTitle" id="newPostTitle">
                    <p></p>
                <label for="post-body">Post content:</label>
                <textarea id="post-body" rows="10"></textarea>
                    <p></p>
                <label for="post-categories">Category Types:</label>
                <input id="categories" name="post-categories" id="categories">
                <p></p>
                <p></p>
                <button id="addPost">Add Post</button>
            </div>
        </div>

    </div>

</div>

<!-- Add
 additional entries to blog.json and make sure your changes are reflected on the page.
 -->

<script src="/js/jQuery.js"></script>

<script>
    "use strict";

(function() {


    var posts = [];
    /*Use ajax to load contents of blog.json*/
    var ajaxRequest = $.get('/data/blog.json');

    var retrieveAllPosts = function() {
        
        ajaxRequest.always(function() {
            console.log('Request sent');
        });

        ajaxRequest.fail(function(data,error) {
            console.log('The request failed. Please check your path or your file to make sure it is in valid JSON format.');
        });
     
        ajaxRequest.done(function(data,error) {
            $.each(data, function(index, value) {
                addPost(value);
            });
        });
    };

    var addPost = function(post) {
        posts.push(post);

        var header = '<h2>' + post.title + '</h2>';
        var content = '<p>' + post.content + '</p>';
        var categories = '<h3>' + 'Categories: ' + post.categories + '</h3>';
        var date = '<h4>' + 'Date: ' + post.date + '</h4>';

        var htmlString = header + content + date + categories + '<br>';
        $('#posts').append(htmlString);
    };
    
    $('#addPost').click(function() {
        var title = $('#post-title').val();
        var body = $('#post-body').val();
        var categories = $('#categories').val();
        var date = new Date().toString();

        var post = {
            "title": title,
            "content": body,
            "date": date,
            "categories": categories
        }
        addPost(post);
    });
    
    retrieveAllPosts();
})()

    </script>
</body>
</html>

